<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Riin Valeña</title>
  <script>
    // Apply dark mode IMMEDIATELY before page renders to prevent white flash
    (function() {
      const saved = localStorage.getItem('darkMode');
      if (saved === 'true') {
        document.documentElement.style.backgroundColor = '#1a1a1a';
        document.documentElement.className = 'dark-mode';
        if (document.body) {
          document.body.style.backgroundColor = '#1a1a1a';
          document.body.className = 'dark-mode';
        } else {
          // If body doesn't exist yet, set it when it loads
          const observer = new MutationObserver(function(mutations) {
            if (document.body) {
              document.body.style.backgroundColor = '#1a1a1a';
              document.body.className = 'dark-mode';
              observer.disconnect();
            }
          });
          observer.observe(document.documentElement, { childList: true });
        }
      }
    })();
  </script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <style>
    @font-face {
      font-display: block;
      font-family: "Neue Haas Grotesk";
      src: url("https://type.cargo.site/files/NeueHaasGroteskText-Regular.woff") format("woff");
      font-style: normal;
      font-weight: normal;
    }
    body {
      background: #ffffff;
      color: #1a1a1a;
      font-family: "Neue Haas Grotesk", -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      line-height: 1.6;
      transition: background-color 0.8s ease-in-out, color 0.8s ease-in-out;
      min-height: 100vh;
      overflow-x: hidden;
    }
    body.dark-mode {
      background: #1a1a1a;
      color: #ffffff;
    }
    html {
      background: #ffffff;
      transition: background-color 0.8s ease-in-out;
      overflow: hidden;
      height: 100%;
    }
    html.dark-mode {
      background: #1a1a1a;
    }
    body.dark-mode html {
      background: #1a1a1a;
    }
    body.dark-mode .text-gray-400 {
      color: #9ca3af;
    }
    body.dark-mode .text-gray-500 {
      color: #6b7280;
    }
    body.dark-mode .text-gray-600 {
      color: #9ca3af;
    }
    html {
      scroll-behavior: smooth;
    }
    /* Custom minimal scrollbar */
    ::-webkit-scrollbar {
      width: 4px;
      height: 4px;
    }
    ::-webkit-scrollbar-track {
      background: #ffffff;
      border-radius: 0;
      transition: background 0.8s ease-in-out;
    }
    body.dark-mode ::-webkit-scrollbar-track {
      background: #1a1a1a;
    }
    ::-webkit-scrollbar-thumb {
      background: #000000;
      border-radius: 0;
      -webkit-border-radius: 0;
    }
    body.dark-mode ::-webkit-scrollbar-thumb {
      background: #ffffff;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: #000000;
      border-radius: 0;
      -webkit-border-radius: 0;
    }
    body.dark-mode ::-webkit-scrollbar-thumb:hover {
      background: #ffffff;
    }
    /* Firefox scrollbar */
    * {
      scrollbar-width: thin;
      scrollbar-color: #000000 #ffffff;
    }
    body.dark-mode * {
      scrollbar-color: #ffffff #1a1a1a;
    }
    a {
      color: inherit;
      text-decoration: none;
      transition: opacity 0.2s;
    }
    a:hover {
      opacity: 0.6;
    }
    button.js-open-modal {
      background: none;
      border: none;
      padding: 0;
      margin: 0;
      cursor: pointer;
      font-family: inherit;
      font-weight: inherit;
      display: inline;
      line-height: inherit;
      text-decoration: none;
      transition: opacity 0.2s;
    }
    .tab-button {
      background: none;
      border: none;
      padding: 0;
      cursor: pointer;
      font: inherit;
      transition: opacity 0.2s;
    }
    .tab-controls {
      position: relative;
      z-index: 5;
    }
    .tab-button.active {
      color: #1a1a1a;
    }
    body.dark-mode .tab-button.active {
      color: #ffffff;
    }
    /* Dark mode toggle button */
    .dark-mode-toggle {
      background: none;
      border: none;
      padding: 0;
      cursor: pointer;
      font-size: 14px;
      color: inherit;
      transition: opacity 0.2s;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      vertical-align: middle;
      line-height: 1;
    }
    .dark-mode-toggle:hover {
      opacity: 0.6;
    }
    .dark-mode-toggle svg {
      width: 14px;
      height: 14px;
      stroke: currentColor;
      fill: none;
      stroke-width: 1.5;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
    .tab-content {
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
      pointer-events: none;
    }
    .tab-content.hidden {
      display: none;
    }
    .tab-content.active {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }
    @media (prefers-reduced-motion: reduce) {
      .tab-content {
        transition: none;
        transform: none;
      }
    }
    #page-content {
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
      position: relative;
      z-index: 1;
    }
    #page-content.loaded {
      opacity: 1;
    }
    @media (prefers-reduced-motion: reduce) {
      #page-content {
        transition: none;
      }
      #page-content.loaded {
        opacity: 1;
      }
    }
    article img {
      display: block;
      width: 100%;
      height: auto;
      max-width: 100%;
      user-drag: none;
      -webkit-user-drag: none;
      user-select: none;
      -moz-user-select: none;
      -webkit-user-select: none;
      -ms-user-select: none;
    }
    article video {
      display: block;
      width: 100%;
      height: auto;
      max-width: 100%;
    }
    /* Ensure uniform thumbnail sizing for slider media */
    .projects-slider article img,
    .projects-slider article video {
      aspect-ratio: 16 / 9;
      object-fit: cover;
    }
    .project-slide > img,
    .project-slide > video {
      position: relative;
      z-index: 1;
      transition: transform 0.48s cubic-bezier(0.22, 0.61, 0.36, 1),
                  box-shadow 0.48s cubic-bezier(0.22, 0.61, 0.36, 1),
                  filter 0.48s cubic-bezier(0.22, 0.61, 0.36, 1);
      transform-origin: center;
      will-change: transform;
      pointer-events: auto;
      user-select: none;
    }
    @media (prefers-reduced-motion: reduce) {
      .project-slide > img,
      .project-slide > video {
        transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
      }
    }
    .projects-slider:not(.is-moving) .project-slide > img:hover,
    .projects-slider:not(.is-moving) .project-slide > video:hover {
      z-index: 40;
      transform: translateY(-18px) scale(1.26);
      filter: saturate(1.05);
    }
    /* Projects Slider */
    .projects-slider-container {
      overflow-x: auto;
      overflow-y: visible;
      width: 100vw;
      position: relative;
      z-index: 20;
      margin-left: calc(-50vw + 50%);
      margin-right: calc(-50vw + 50%);
      padding-left: calc(50vw - 50%);
      padding-right: calc(50vw - 50%);
      padding-top: 32px;
      cursor: grab;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none; /* Firefox */
      -ms-overflow-style: none; /* IE and Edge */
      touch-action: pan-x; /* Hint that we only pan horizontally */
      box-sizing: border-box;
    }
    .projects-slider-container::-webkit-scrollbar {
      display: none; /* Chrome, Safari, Opera */
    }
    .projects-slider-container:active {
      cursor: grabbing;
    }
    .projects-slider {
      display: flex;
      gap: 64px;
      padding-right: calc(50vw - 50%);
      width: max-content;
      align-items: stretch;
      position: relative;
      overflow: visible;
      z-index: 20;
    }
    .project-slide {
      flex: 0 0 auto;
      width: 400px;
      max-width: 400px;
      display: flex;
      flex-direction: column;
      position: relative;
    }
    /* Keep CTA buttons/links aligned at the bottom for uniformity */
    .project-slide > .js-open-modal,
    .project-slide > a {
      margin-top: auto;
      align-self: flex-start;
      display: inline-block;
    }
    /* Clamp descriptions and tech stacks to two lines for uniform cards */
    .projects-slider .project-slide p.text-gray-600,
    .projects-slider .project-slide p.text-gray-500 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    /* Ensure single-line descriptions still occupy two-line space */
    .projects-slider .project-slide p.text-gray-600 {
      line-height: 1.6;
      min-height: 3.2em; /* 2 lines * 1.6 line-height */
    }
    /* Project titles: match description size with black text */
    .project-slide h3 {
      font-size: 0.75rem; /* text-xs */
      line-height: 1.6;
      margin-bottom: 0.75rem; /* mb-3 */
      color: #000000;
      font-weight: 700;
      transition: color 0.8s ease-in-out;
    }
    body.dark-mode .project-slide h3 {
      color: #ffffff;
    }
    @media (max-width: 768px) {
      .project-slide {
        width: 85vw;
        max-width: 85vw;
      }
      .projects-slider-container {
        margin-left: -32px;
        margin-right: -32px;
        padding-left: 32px;
        padding-right: 32px;
        padding-top: 24px;
        width: calc(100% + 64px);
      }
      .projects-slider {
        padding-right: 32px;
        gap: 16px;
      }
    }
    .projects-slider.dragging {
      scroll-behavior: auto;
    }
    #loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #ffffff;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 1;
      transition: opacity 1s cubic-bezier(0.4, 0, 0.2, 1), 
                  transform 1s cubic-bezier(0.4, 0, 0.2, 1),
                  background-color 1s cubic-bezier(0.4, 0, 0.2, 1);
      pointer-events: all;
      transform: scale(1);
    }
    body.dark-mode #loading-screen {
      background: #1a1a1a;
    }
    #loading-screen.hidden {
      opacity: 0;
      background-color: rgba(255, 255, 255, 0);
      transform: scale(0.95);
      pointer-events: none;
    }
    body.dark-mode #loading-screen.hidden {
      background-color: rgba(26, 26, 26, 0);
    }
    /* Disable current page nav link */
    .nav-link-disabled {
      pointer-events: none;
      opacity: 0.6;
      cursor: default;
    }
    .loading-content {
      text-align: center;
      transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1), 
                  transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }
    #loading-screen.hidden .loading-content {
      opacity: 0;
      transform: translateY(-20px) scale(0.9);
    }
    .loading-name {
      font-size: 14px;
      letter-spacing: 0.1em;
      color: #1a1a1a;
      margin-bottom: 24px;
      opacity: 0;
      animation: fadeInUp 0.6s ease-out 0.2s forwards;
      transition: color 0.3s ease;
    }
    body.dark-mode .loading-name {
      color: #ffffff;
    }
    .loading-line {
      width: 120px;
      height: 1px;
      background: #1a1a1a;
      margin: 0 auto;
      position: relative;
      overflow: hidden;
      transition: background 0.3s ease;
    }
    body.dark-mode .loading-line {
      background: #ffffff;
    }
    body.dark-mode .loading-line::after {
      background: #ffffff;
    }
    .loading-line::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: #1a1a1a;
      animation: loadingProgress 1.5s ease-in-out infinite;
    }
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    @keyframes loadingProgress {
      0% {
        left: -100%;
      }
      50% {
        left: 100%;
      }
      100% {
        left: 100%;
      }
    }
    @media (prefers-reduced-motion: reduce) {
      .loading-name {
        animation: none;
        opacity: 1;
      }
      .loading-line::after {
        animation: none;
      }
      #loading-screen {
        transition: opacity 0.3s ease-out, background-color 0.3s ease-out;
      }
      #loading-screen.hidden {
        transform: none;
      }
      .loading-content {
        transition: opacity 0.3s ease-out;
      }
      #loading-screen.hidden .loading-content {
        transform: none;
      }
    }
    /* Modal open animation */
    #project-modal {
      opacity: 0;
      transition: opacity 0.25s ease;
    }
    #project-modal.show {
      opacity: 1;
    }
    #project-modal .modal-panel {
      transform: translateY(8px) scale(0.98);
      opacity: 0;
      transition: transform 0.25s ease, opacity 0.25s ease;
      will-change: transform, opacity;
    }
    #project-modal.show .modal-panel {
      transform: translateY(0) scale(1);
      opacity: 1;
    }
    @media (prefers-reduced-motion: reduce) {
      #project-modal,
      #project-modal .modal-panel {
        transition: none;
      }
    }
    /* Dark mode styles for modal */
    body.dark-mode #project-modal .modal-panel {
      background: #1a1a1a;
      color: #ffffff;
    }
    body.dark-mode #project-modal #modal-image-container {
      background: #111111;
    }
    body.dark-mode #project-modal #modal-prev,
    body.dark-mode #project-modal #modal-next {
      background: rgba(255, 255, 255, 0.08);
      color: #9ca3af;
    }
    body.dark-mode #project-modal #modal-prev:hover,
    body.dark-mode #project-modal #modal-next:hover {
      color: #ffffff;
      background: rgba(255, 255, 255, 0.12);
    }
    body.dark-mode #project-modal #modal-close {
      color: #9ca3af;
    }
    body.dark-mode #project-modal #modal-close:hover {
      color: #ffffff;
    }
    /* Navbar explicit backgrounds for custom dark mode */
    nav.fixed-nav {
      background: #ffffff;
      transition: background-color 0.8s ease-in-out, color 0.8s ease-in-out;
    }
    .nav-brand {
      color: #000000;
      transition: color 0.8s ease-in-out;
    }
    body.dark-mode .nav-brand {
      color: #ffffff;
    }
    body.dark-mode nav.fixed-nav {
      background: #1a1a1a;
    }
    /* Minimal hamburger menu */
    .burger {
      display: none;
      background: none;
      border: 0;
      padding: 8px;
      cursor: pointer;
      z-index: 60;
      color: inherit;
      transition: transform 0.25s ease;
    }
    .burger .material-symbols-outlined {
      font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
      font-size: 24px;
      line-height: 1;
      display: inline-block;
      transition: transform 0.25s ease, opacity 0.25s ease;
    }
    nav.fixed-nav.open .burger { transform: rotate(90deg); }
    /* Links container */
    .nav-links { display: flex; gap: 2rem; align-items: center; transition: background-color 0.8s ease-in-out, color 0.8s ease-in-out; }
    @media (max-width: 640px) {
      .burger { display: inline-flex; align-items: center; justify-content: center; }
      .nav-links {
        display: flex;
        position: fixed;
        top: 0; right: 0; bottom: 0; left: 0;
        background: #ffffff;
        padding: 96px 24px 24px 24px;
        flex-direction: column;
        gap: 24px;
        align-items: center;
        text-align: center;
        z-index: 55;
        transform: translateX(100%);
        transition: transform 0.3s ease, background-color 0.8s ease-in-out, color 0.8s ease-in-out;
      }
      body.dark-mode .nav-links { background: #1a1a1a; }
      nav.fixed-nav.open .nav-links { transform: translateX(0); }
    }
  </style>
</head>
<body style="overflow: hidden;">
  <!-- Loading Screen -->
  <div id="loading-screen">
    <div class="loading-content">
      <div class="loading-name">Riin Valeña</div>
      <div class="loading-line"></div>
    </div>
  </div>
  <script>
    // Ensure loading screen is visible immediately
    (function() {
      const loadingScreen = document.getElementById('loading-screen');
      const pageContent = document.getElementById('page-content');
      if (loadingScreen) {
        loadingScreen.style.display = 'flex';
        loadingScreen.style.opacity = '1';
      }
      if (pageContent) {
        pageContent.style.opacity = '0';
        pageContent.style.pointerEvents = 'none';
      }
    })();
  </script>
  <div id="page-content">
  <nav class="flex justify-between items-center px-8 py-8 fixed top-0 left-0 right-0 z-50 fixed-nav">
    <a href="index.html" class="text-xs nav-brand">Riin Valeña</a>
    <button id="burger-btn" class="burger" aria-label="Open menu" aria-expanded="false" aria-controls="nav-links">
      <span class="material-symbols-outlined">menu</span>
    </button>
    <ul id="nav-links" class="nav-links text-xs items-center">
      <li class="flex items-center">
        <button id="dark-mode-toggle" class="dark-mode-toggle" aria-label="Toggle dark mode">
          <svg id="moon-icon" viewBox="0 0 24 24" class="dark-mode-icon">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
          <svg id="sun-icon" viewBox="0 0 24 24" class="dark-mode-icon" style="display: none;">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
        </button>
      </li>
      <li><a href="index.html">Home</a></li>
      <li><a href="resume.html">Resume</a></li>
      <li><a href="about.html">About</a></li>
      <li><a href="contact.html">Contact</a></li>
    </ul>
  </nav>

  <main class="min-h-screen px-8 pt-32 pb-0 max-w-6xl mx-auto">
    <!-- PROJECTS -->
    <section id="projects" class="mb-0">
      <h2 class="text-xs text-gray-400 mb-12">Projects</h2>
      
      <!-- Tabs -->
      <div class="tab-controls flex gap-4 mb-8 text-xs">
        <button class="tab-button active text-gray-400 hover:opacity-60" data-tab="web-design">Web Design</button>
        <button class="tab-button text-gray-400 hover:opacity-60" data-tab="multimedia">Multimedia</button>
      </div>

      <!-- Web Design Tab -->
      <div id="web-design" class="tab-content active">
        <div class="projects-slider-container">
          <div class="projects-slider" data-slider="web-design">
            <article class="project-slide">
              <img src="assets/img/vacantvuecover.png" alt="VacantVue" class="w-full mb-6">
              <h3 class="mb-3">VacantVue</h3>
              <p class="text-xs text-gray-600 mb-3">Smart parking management system with IoT sensors, real-time availability, reservations, and cashless payments.</p>
              <p class="text-xs text-gray-500 mb-3">HTML5, CSS3, JavaScript, Bootstrap, PHP, Firebase, Arduino, PayMongo</p>
              <button data-project="alpha" class="js-open-modal text-xs text-gray-500 hover:opacity-60">View details</button>
            </article>

            <article class="project-slide">
              <img src="assets/img/cccover.png" alt="Capstone Compass" class="w-full mb-6">
              <h3 class="mb-3">Capstone Compass</h3>
              <p class="text-xs text-gray-600 mb-3">Project management platform for students and mentors with group chat, progress tracking, and task management.</p>
              <p class="text-xs text-gray-500 mb-3">Laravel, PHP, MySQL, Bootstrap, JavaScript</p>
              <button data-project="epsilon" class="js-open-modal text-xs text-gray-500 hover:opacity-60">View details</button>
            </article>

            <article class="project-slide">
              <img 
                src="assets/img/kapejuan/1.png" 
                alt="Kape Juan" 
                class="w-full mb-6" 
                data-slideshow="kape"
              >
              <h3 class="mb-3">Kape Juan</h3>
              <p class="text-xs text-gray-600 mb-3">Kape Juan is a modern, responsive coffee shop web app for browsing the menu, placing orders, and managing purchases, powered by a React frontend and a Supabase-backed data layer with Stripe-based checkout.</p>
              <p class="text-xs text-gray-500 mb-3">React, React Router, Framer Motion, Tailwind, Chart.js, Stripe, Supabase, React Context, Babel, ESLint</p>
              <button data-project="kape" class="js-open-modal text-xs text-gray-500 hover:opacity-60">View details</button>
            </article>

            <article class="project-slide">
              <img src="assets/img/portfoliocover.png" alt="Portfolio Site" class="w-full mb-6">
              <h3 class="mb-3">Portfolio Site</h3>
              <p class="text-xs text-gray-600 mb-3">Responsive portfolio website with clean design.</p>
              <p class="text-xs text-gray-500 mb-3">HTML5, CSS3, JavaScript, Tailwind CSS</p>
              <a href="https://github.com/riiny/riiny" target="_blank" class="text-xs text-gray-500 hover:opacity-60">GitHub</a>
            </article>
          </div>
        </div>
      </div>

      <!-- Multimedia Tab -->
      <div id="multimedia" class="tab-content hidden">
        <div class="projects-slider-container">
          <div class="projects-slider" data-slider="multimedia">
            <article class="project-slide">
              <img src="assets/img/hhcover.png" alt="Hiwa-hiwa" class="w-full mb-6">
              <h3 class="mb-3">Hiwa-Hiwa</h3>
              <p class="text-xs text-gray-600 mb-3">Digital collage posters reimagining musical icons through layered, fragmented compositions.</p>
              <p class="text-xs text-gray-500 mb-3">Adobe Photoshop, Adobe Lightroom</p>
              <a href="https://www.behance.net/gallery/211533245/HIWA-HIWA-Collage-Art-Series" target="_blank" class="text-xs text-gray-500 hover:opacity-60">Behance</a>
            </article>

            <article class="project-slide">
              <img src="assets/img/vintagecover.png" alt="Vintage Shirt Design" class="w-full mb-6">
              <h3 class="mb-3">Vintage Shirt Design</h3>
              <p class="text-xs text-gray-600 mb-3">T-shirt designs blending retro aesthetics with bold typography celebrating impactful athletes.</p>
              <p class="text-xs text-gray-500 mb-3">Adobe Photoshop, Adobe Lightroom</p>
              <a href="https://www.behance.net/gallery/212629569/Vintage-Shirt-Designs-Sports" target="_blank" class="text-xs text-gray-500 hover:opacity-60">Behance</a>
            </article>

            <article class="project-slide">
              <video 
                id="vc-trailer-video"
                class="w-full mb-6" 
                muted 
                loop
                preload="auto"
                poster="assets/img/vctrailer.png"
              >
                <source src="assets/vids/vctrailer.mp4" type="video/mp4">
              </video>
              <h3 class="mb-3">VacantVue Trailer</h3>
              <p class="text-xs text-gray-600 mb-3">Promotional video showcasing UI/UX design and Arduino-powered engineering for the smart parking solution.</p>
              <p class="text-xs text-gray-500 mb-3">Adobe Premiere Pro, Adobe Photoshop</p>
              <button data-project="theta" class="js-open-modal text-xs text-gray-500 hover:opacity-60">View details</button>
            </article>

            <article class="project-slide">
              <img src="assets/img/csm.gif" alt="2019 mini project" class="w-full mb-6">
              <h3 class="mb-3">2019 Mini Project</h3>
              <p class="text-xs text-gray-600 mb-3">Music visualizers using images and animated GIFs to enhance visual storytelling.</p>
              <p class="text-xs text-gray-500 mb-3">Adobe Premiere Pro, Adobe Photoshop</p>
              <button data-project="iota" class="js-open-modal text-xs text-gray-500 hover:opacity-60">View details</button>
            </article>
          </div>
        </div>
      </div>
    </section>

  </main>
  
  <script>
    // Preload all images including those in hidden tabs
    (function() {
      const imageSources = [
        'assets/img/vacantvuecover.png',
        'assets/img/cccover.png',
        'assets/img/portfoliocover.png',
        'assets/img/kapejuan/1.png',
        'assets/img/kapejuan/2.png',
        'assets/img/kapejuan/3.png',
        'assets/img/kapejuan/4.png',
        'assets/img/kapejuan/5.png',
        'assets/img/kapejuan/6.png',
        'assets/img/kapejuan/7.png',
        'assets/img/hhcover.png',
        'assets/img/vintagecover.png',
        'assets/img/vctrailer.png',
        'assets/img/csm.gif'
      ];
      
      imageSources.forEach(src => {
        const img = new Image();
        img.src = src;
      });
    })();
  </script>
  
  <script>
    // Kape Juan slideshow (0.2s per frame)
    (function() {
      const slideshowEl = document.querySelector('[data-slideshow="kape"]');
      if (!slideshowEl) return;
      const frames = [
        'assets/img/kapejuan/1.png',
        'assets/img/kapejuan/2.png',
        'assets/img/kapejuan/3.png',
        'assets/img/kapejuan/4.png',
        'assets/img/kapejuan/5.png',
        'assets/img/kapejuan/6.png',
        'assets/img/kapejuan/7.png'
      ];
      let idx = 0;
      const frameDelay = 200; // milliseconds
      setInterval(() => {
        idx = (idx + 1) % frames.length;
        slideshowEl.src = frames[idx];
      }, frameDelay);
    })();
  </script>
 
  <script>
    // Loading screen - show for 2 seconds, then hide
    (function() {
      // Wait for DOM to be ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initLoading);
      } else {
        initLoading();
      }
      
      function initLoading() {
        const loadingScreen = document.getElementById('loading-screen');
        const pageContent = document.getElementById('page-content');
        
        // Ensure loading screen is visible
        if (loadingScreen) {
          loadingScreen.style.display = 'flex';
          loadingScreen.style.opacity = '1';
        }
        
        // Prevent interaction during loading
        if (pageContent) {
          pageContent.style.pointerEvents = 'none';
          pageContent.style.opacity = '0';
        }
        
        // Hide loading screen after 2 seconds
        setTimeout(() => {
          if (loadingScreen) {
            loadingScreen.classList.add('hidden');
          }
          // Re-enable interaction, fade in page content
          if (pageContent) {
            pageContent.style.pointerEvents = '';
            // Remove inline opacity style to allow CSS transition to work
            pageContent.style.removeProperty('opacity');
            // Use double requestAnimationFrame to ensure the style is cleared before adding class
            requestAnimationFrame(() => {
              requestAnimationFrame(() => {
                pageContent.classList.add('loaded');
              });
            });
          }
          // Remove loading screen from DOM after fade out
          setTimeout(() => {
            if (loadingScreen) {
              loadingScreen.remove();
            }
          }, 1000); // Wait for fade out transition (1s)
        }, 2000); // 2 seconds
      }
    })();
  </script>
  
  <!-- Project Modal -->
  <div id="project-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black bg-opacity-50 px-4 py-8" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="bg-white max-w-4xl w-full max-h-[90vh] overflow-auto p-12 relative modal-panel">
      <button id="modal-close" class="absolute top-6 right-6 text-xl text-gray-400 hover:text-gray-600">×</button>
      <h3 id="modal-title" class="text-base mb-6 uppercase"></h3>
      <div id="modal-carousel" class="relative mb-8">
        <button id="modal-prev" class="absolute left-2 top-1/2 -translate-y-1/2 bg-white bg-opacity-80 px-3 py-2 text-gray-600 hover:text-gray-900 text-lg">‹</button>
        <div id="modal-image-container" class="w-full bg-gray-100 flex items-center justify-center overflow-hidden min-h-[400px]">
        </div>
        <button id="modal-next" class="absolute right-2 top-1/2 -translate-y-1/2 bg-white bg-opacity-80 px-3 py-2 text-gray-600 hover:text-gray-900 text-lg">›</button>
      </div>
      <p id="modal-desc" class="text-xs text-gray-600 mb-6"></p>
      <p id="modal-tech" class="text-xs text-gray-500"></p>
    </div>
  </div>

  <script>
    (function(){
      const projects = {
        alpha: {
          title: 'VACANTVUE',
          long: 'VacantVue is a smart parking management system I led as the Project Leader for my capstone thesis. It provides real-time slot availability, easy reservations, and secure cashless payments through a web and mobile platform integrated with IoT sensors.\n\nIn this role, I managed the entire development process from planning and task delegation, to testing, developing, and deployment, ensuring the system aligned with our objectives. Built with PHP, Firebase, and Arduino-based sensors, VacantVue delivers real-time monitoring through ultrasonic sensors and an ESP32 Wi-Fi module, synchronizing data with Firebase for accurate updates. Motorists can reserve slots and pay seamlessly via PayMongo, while attendants and administrators access dashboards for walk-in transactions, monitoring, and reporting. By applying Agile Scrum methodology and ISO-aligned quality standards, I guided the team in creating a reliable, sustainable, and user-friendly solution that reduces parking search times and enhances urban mobility.', 
          tech: ['HTML5','CSS3','JavaScript','Bootstrap','PHP','Firebase','Arduino','PayMongo'],
          images: [
            'assets/img/vc1.png',
            'assets/img/vc2.png'
          ]
        },
        epsilon: {
          title: 'CAPSTONE COMPASS',
          long: 'Capstone Compass is a comprehensive project management platform designed specifically for academic capstone projects. It facilitates seamless collaboration between students, mentors, and advisors through features like real-time group chat, progress tracking, task management, and streamlined submission handling. The platform streamlines the entire capstone journey from initial planning to final presentation, ensuring all stakeholders stay connected and informed throughout the project lifecycle.',
          tech: ['Laravel','PHP','MySQL','Bootstrap','JavaScript'],
          images: [
            'assets/img/cc1.png',
            'assets/img/cc2.png',
            'assets/img/cc3.png',
            'assets/img/cc4.png'
          ]
        },
        kape: {
          title: 'KAPE JUAN',
          long: 'The frontend is built with React and React Router, featuring a clean, mobile-first UI styled with utility classes and enhanced with smooth page transitions via framer-motion. Customers can browse items, add them to a persistent cart (via a custom CartContext), complete checkout using a streamlined form with Stripe\'s elements, and land on a dynamic thank-you page showing their order details. The app includes authenticated routes, role-aware redirects (customer vs staff/admin), and an admin/staff area leveraging Chart.js for analytics. UX touches include a centered, simplified footer, back-to-top control, and defensive blocking against double submissions.\n\nOn the backend side, Supabase provides authentication, database, and RESTful data access through its JavaScript client. Core tables include orders, order_items, payments, and user_profiles; the app creates orders, inserts line items, updates payment status, and fetches order details securely per user. Payment uses Stripe (test mode) with the Stripe JS SDK and React Stripe Elements; in development flows, payment confirmation is simulated for instant UX, while still persisting payment records. Environment-driven configuration (publishable keys, Supabase URL/anon key) keeps secrets out of the client bundle and enables smooth deployment.',
          tech: ['React','React Router','Framer Motion','Tailwind','Chart.js','Stripe','Supabase','React Context','Babel','ESLint'],
          images: [
            'assets/img/kapejuan/1.png',
            'assets/img/kapejuan/2.png',
            'assets/img/kapejuan/3.png',
            'assets/img/kapejuan/4.png',
            'assets/img/kapejuan/5.png',
            'assets/img/kapejuan/6.png',
            'assets/img/kapejuan/7.png'
          ]
        },
        theta: {
          title: 'VACANTVUE TRAILER',
          long: 'A promotional video project showcasing the VacantVue parking management system. Created using Adobe Premiere Pro, highlighting the key features, user experience, and technical capabilities of the IoT-based solution.',
          tech: ['Adobe Premiere Pro','Adobe Photoshop'],
          images: [
            'assets/vids/vctrailereal.mp4',
          ]
        },
        iota: {
          title: '2019 MINI PROJECT',
          long: 'A creative video project from 2019 where I experimented with music visualizers for my favorite tracks. This project challenged my creativity to design simple, entertaining videos using only images and animated GIFs to complement the atmosphere and enhance the visual storytelling of each song. Each video was carefully crafted to synchronize with the music, creating immersive audio-visual experiences that showcase early experimentation with motion graphics and video editing techniques.',
          tech: ['Adobe Premiere Pro','Adobe Photoshop'],
          images: [
            'assets/vids/mini1.mp4',
            'assets/vids/mini2.mp4',
            'assets/vids/mini3.mp4',
            'assets/vids/mini4.mp4',
            'assets/vids/mini5.mp4',
            'assets/vids/mini6.mp4'
          ]
        }
      };

      const modal = document.getElementById('project-modal');
      const titleEl = document.getElementById('modal-title');
      const descEl = document.getElementById('modal-desc');
      const techEl = document.getElementById('modal-tech');
      const imgContainer = document.getElementById('modal-image-container');
      const prevBtn = document.getElementById('modal-prev');
      const nextBtn = document.getElementById('modal-next');
      const closeBtn = document.getElementById('modal-close');

      let current = { key: null, idx: 0 };

      function openModal(key){
        const p = projects[key];
        if(!p) return;
        current.key = key; 
        current.idx = 0;
        titleEl.textContent = p.title;
        descEl.innerHTML = p.long.replace(/\n\n/g, '<br><br>');
        techEl.textContent = p.tech.join(', ');
        
        if(p.images.length <= 1) {
          prevBtn.style.display = 'none';
          nextBtn.style.display = 'none';
        } else {
          prevBtn.style.display = 'block';
          nextBtn.style.display = 'block';
        }
        
        renderImage();
        modal.classList.remove('hidden');
        // Trigger open animation
        requestAnimationFrame(() => {
          modal.classList.add('show');
        });
        modal.setAttribute('aria-hidden','false');
        document.body.style.overflow = 'hidden';
      }

      function closeModal(){
        // Remove show to allow a quick fade-out, then hide
        modal.classList.remove('show');
        setTimeout(() => {
          modal.classList.add('hidden');
        }, 200);
        modal.setAttribute('aria-hidden','true');
        document.body.style.overflow = '';
        current = { key: null, idx: 0 };
      }

      function renderImage(){
        const p = projects[current.key];
        if(!p) return;
        const url = p.images[current.idx];
        imgContainer.innerHTML = '';
        
        if(url.endsWith('.mp4') || url.endsWith('.webm') || url.endsWith('.ogg')) {
          const video = document.createElement('video');
          video.src = url;
          video.className = 'w-full object-contain';
          const isKapeVideo = current.key === 'kape';
          video.controls = !isKapeVideo;
          video.muted = true;
          if (isKapeVideo) {
            video.loop = true;
            video.autoplay = true;
            video.setAttribute('playsinline', '');
            video.setAttribute('muted', '');
            video.setAttribute('loop', '');
            video.setAttribute('autoplay', '');
            // ensure playback starts when ready
            video.addEventListener('canplay', () => {
              video.play().catch(() => {});
            }, { once: true });
          }
          imgContainer.appendChild(video);
        } else {
          const img = document.createElement('img');
          img.src = url;
          img.alt = p.title;
          img.className = 'w-full object-contain';
          imgContainer.appendChild(img);
        }
      }

      prevBtn.addEventListener('click', ()=>{
        const p = projects[current.key];
        if(!p) return;
        current.idx = (current.idx - 1 + p.images.length) % p.images.length;
        renderImage();
      });

      nextBtn.addEventListener('click', ()=>{
        const p = projects[current.key];
        if(!p) return;
        current.idx = (current.idx + 1) % p.images.length;
        renderImage();
      });

      closeBtn.addEventListener('click', closeModal);

      document.querySelectorAll('.js-open-modal').forEach(btn=>{
        btn.addEventListener('click', (e)=>{
          const key = btn.getAttribute('data-project');
          openModal(key);
        });
      });

      document.addEventListener('keydown', (e)=>{
        if(modal.classList.contains('hidden')) return;
        if(e.key === 'Escape') closeModal();
        if(e.key === 'ArrowLeft') prevBtn.click();
        if(e.key === 'ArrowRight') nextBtn.click();
      });

      modal.addEventListener('click', (e)=>{
        if(e.target === modal) closeModal();
      });
    })();
  </script>
  <script>
    // Tab switching functionality with animation
    (function(){
      const tabButtons = document.querySelectorAll('.tab-button');
      const tabContents = document.querySelectorAll('.tab-content');
      const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      tabButtons.forEach(button => {
        button.addEventListener('click', () => {
          const targetTab = button.getAttribute('data-tab');
          const targetContent = document.getElementById(targetTab);
          
          // Don't do anything if clicking the same tab
          if (button.classList.contains('active')) return;

          // Remove active class from all buttons
          tabButtons.forEach(btn => btn.classList.remove('active'));
          // Add active class to clicked button
          button.classList.add('active');

          // Find currently active tab content
          const activeContent = document.querySelector('.tab-content.active');
          
          if (prefersReducedMotion) {
            // Instant switch for reduced motion
            tabContents.forEach(content => {
              content.classList.remove('active', 'hidden');
              if (content !== targetContent) {
                content.classList.add('hidden');
              }
            });
            targetContent.classList.remove('hidden');
            targetContent.classList.add('active');
          } else {
            // Animated transition
            if (activeContent) {
              // Fade out current tab
              activeContent.classList.remove('active');
              
              // Wait for fade-out to start, then prepare new tab
              setTimeout(() => {
                // Hide current tab
                activeContent.classList.add('hidden');
                
                // Show new tab (but keep it invisible - it has opacity 0 by default)
                targetContent.classList.remove('hidden');
                
                // Force reflow to ensure the element is rendered in the DOM
                void targetContent.offsetHeight;
                
                // Trigger fade-in animation on next frame
                requestAnimationFrame(() => {
                  requestAnimationFrame(() => {
                    targetContent.classList.add('active');
                  });
                });
              }, 150); // Half of transition duration for smoother overlap
            } else {
              // If no active content, just show the target
              tabContents.forEach(content => {
                content.classList.remove('active', 'hidden');
                if (content !== targetContent) {
                  content.classList.add('hidden');
                }
              });
              targetContent.classList.remove('hidden');
              
              // Force reflow
              void targetContent.offsetHeight;
              
              requestAnimationFrame(() => {
                targetContent.classList.add('active');
              });
            }
          }
        });
      });
    })();
  </script>
  <script>
    // Projects slider drag functionality with physics-based movement
    (function() {
      const containers = document.querySelectorAll('.projects-slider-container');
      
      containers.forEach(container => {
        // Physics state
        const sliderEl = container.querySelector('.projects-slider');
        let isDown = false;
        let isDragging = false;
        let dragThreshold = 6;
        let currentPosition = 0;
        let targetPosition = 0;
        let velocity = 0;
        let lastPosition = 0;
        let lastTime = 0;
        let animationFrameId = null;
        let movingState = false;
        let scrollTimeoutId = null;
        
        const updateMovingState = (moving) => {
          if (movingState === moving) return;
          movingState = moving;
          container.classList.toggle('slider-moving', moving);
          if (sliderEl) {
            sliderEl.classList.toggle('is-moving', moving);
          }
        };
        
        // Physics constants
        // Tune heavier, more tactile feel especially on mobile
        const isMobile = window.matchMedia('(max-width: 768px)').matches;
        const FRICTION = isMobile ? 0.92 : 0.92; // Lower = more friction per frame
        const MOMENTUM_MULTIPLIER = isMobile ? 0.8 : 0.8; // Preserve less momentum on mobile
        const ELASTIC_RESISTANCE = isMobile ? 0.18 : 0.18; // Stronger elastic on mobile
        const ELASTIC_THRESHOLD = isMobile ? 120 : 60; // Start elastic a bit earlier on mobile
        const MAX_VELOCITY = isMobile ? 50 : 60; // Cap fling speed
        const DRAG_INTERPOLATION = isMobile ? 0.18 : 0.22; // Softer follow on mobile
        
        // Get bounds
        const getBounds = () => {
          const slider = container.querySelector('.projects-slider');
          if (!slider) return { min: 0, max: 0 };
          const maxScroll = slider.scrollWidth - container.clientWidth;
          return {
            min: 0,
            max: Math.max(0, maxScroll)
          };
        };
        
        // Apply elastic resistance at bounds
        const applyElasticBounds = (pos, bounds) => {
          if (pos < bounds.min) {
            const overshoot = bounds.min - pos;
            if (overshoot > 0) {
              // Elastic resistance - stronger the further you go
              const resistance = Math.min(overshoot / ELASTIC_THRESHOLD, 1);
              return bounds.min - overshoot * (1 - ELASTIC_RESISTANCE * resistance);
            }
          } else if (pos > bounds.max) {
            const overshoot = pos - bounds.max;
            if (overshoot > 0) {
              const resistance = Math.min(overshoot / ELASTIC_THRESHOLD, 1);
              return bounds.max + overshoot * (1 - ELASTIC_RESISTANCE * resistance);
            }
          }
          return pos;
        };
        
        // Physics animation loop
        const animate = (timestamp) => {
          if (!lastTime) lastTime = timestamp;
          const deltaTime = Math.min((timestamp - lastTime) / 16.67, 2); // Normalize to 60fps, cap at 2x
          lastTime = timestamp;
          
          const bounds = getBounds();
          const approxVelocity = Math.abs(velocity);
          const isSettling = Math.abs(targetPosition - currentPosition);
          const currentlyMoving = isDown || approxVelocity > 0.18 || isSettling > 0.3;
          updateMovingState(currentlyMoving);
          
          if (isDown) {
            // While dragging, smoothly interpolate to target with heavy feel
            const diff = targetPosition - currentPosition;
            currentPosition += diff * DRAG_INTERPOLATION; // Heavier, damped movement
            currentPosition = applyElasticBounds(currentPosition, bounds);
            // Clamp scroll position, apply visual elastic offset via transform
            const clamped = Math.min(bounds.max, Math.max(bounds.min, currentPosition));
            const visualOffset = currentPosition - clamped;
            container.scrollLeft = clamped;
            if (sliderEl) {
              if (Math.abs(visualOffset) > 0.5) {
                sliderEl.style.transform = `translateX(${ -visualOffset }px)`;
              } else {
                sliderEl.style.transform = '';
              }
            }
            animationFrameId = requestAnimationFrame(animate);
          } else {
            // Apply friction to velocity (high friction = heavy feel)
            velocity *= FRICTION;
            
            // Update position with velocity
            currentPosition += velocity * deltaTime;
            
            // Apply elastic bounds
            const beforeElastic = currentPosition;
            currentPosition = applyElasticBounds(currentPosition, bounds);
            
            // If we hit a bound, reduce velocity significantly
            if (beforeElastic !== currentPosition) {
              velocity *= 0.35; // Strong damping at bounds
            }
            
            // Snap back to bounds if velocity is very low and we're out of bounds
            if (Math.abs(velocity) < 0.05) {
              if (currentPosition < bounds.min) {
                const snapDiff = bounds.min - currentPosition;
                currentPosition += snapDiff * 0.2; // Smooth snap back
                if (Math.abs(snapDiff) < 0.5) {
                  currentPosition = bounds.min;
                  velocity = 0;
                }
              } else if (currentPosition > bounds.max) {
                const snapDiff = bounds.max - currentPosition;
                currentPosition += snapDiff * 0.2; // Smooth snap back
                if (Math.abs(snapDiff) < 0.5) {
                  currentPosition = bounds.max;
                  velocity = 0;
                }
              }
            }
            
            // Clamp scroll position, apply visual elastic offset via transform
            const clamped = Math.min(bounds.max, Math.max(bounds.min, currentPosition));
            const visualOffset = currentPosition - clamped;
            container.scrollLeft = clamped;
            if (sliderEl) {
              if (Math.abs(visualOffset) > 0.5) {
                sliderEl.style.transform = `translateX(${ -visualOffset }px)`;
              } else {
                sliderEl.style.transform = '';
              }
            }
            
            // Continue animation if there's still movement
            if (Math.abs(velocity) > 0.01 || (currentPosition < bounds.min && Math.abs(bounds.min - currentPosition) > 0.5) || (currentPosition > bounds.max && Math.abs(currentPosition - bounds.max) > 0.5)) {
              animationFrameId = requestAnimationFrame(animate);
            } else {
              animationFrameId = null;
              lastTime = 0;
              updateMovingState(false);
              // Ensure final position is correct
              if (currentPosition < bounds.min) {
                container.scrollLeft = bounds.min;
              } else if (currentPosition > bounds.max) {
                container.scrollLeft = bounds.max;
              }
              if (sliderEl) sliderEl.style.transform = '';
            }
          }
        };
        
        // Start animation loop
        const startAnimation = () => {
          if (!animationFrameId) {
            lastTime = 0;
            animationFrameId = requestAnimationFrame(animate);
          }
        };
        
        // Initialize position
        currentPosition = container.scrollLeft;
        targetPosition = currentPosition;
        
        // Mouse events
        container.addEventListener('mousedown', (e) => {
          // Don't start drag if clicking on a link or button
          if (e.target.closest('a, button')) return;
          
          isDown = true;
          isDragging = false;
          container.style.cursor = 'grabbing';
          container.style.userSelect = 'none';
          updateMovingState(true);
          
          // Stop any ongoing animation
          if (animationFrameId) {
            cancelAnimationFrame(animationFrameId);
            animationFrameId = null;
          }
          
          // Initialize positions
          currentPosition = container.scrollLeft;
          targetPosition = currentPosition;
          lastPosition = e.pageX;
          lastTime = performance.now();
          velocity = 0;
          
          startAnimation();
        });
        
        container.addEventListener('mouseleave', () => {
          if (isDown) {
            isDown = false;
            container.style.cursor = 'grab';
            container.style.userSelect = '';
            startAnimation(); // Continue with momentum
          }
        });
        
        container.addEventListener('mouseup', (e) => {
          if (isDown) {
            isDown = false;
            container.style.cursor = 'grab';
            container.style.userSelect = '';
            
            // Calculate final velocity for momentum
            const now = performance.now();
            const timeDelta = Math.max(now - lastTime, 1);
            const positionDelta = e.pageX - lastPosition;
            
            // Convert mouse movement to scroll velocity (inverse because scroll is opposite to mouse)
            velocity = -(positionDelta / timeDelta) * 16.67 * MOMENTUM_MULTIPLIER;
            
            // If we didn't drag much, allow click events
            if (!isDragging) {
              const clickable = document.elementFromPoint(e.clientX, e.clientY);
              if (clickable) {
                const link = clickable.closest('a, button');
                if (link && !link.hasAttribute('data-project')) {
                  const modalBtn = clickable.closest('.js-open-modal');
                  if (!modalBtn) {
                    link.click();
                  }
                }
              }
            }
            isDragging = false;
            
            // Continue animation with momentum
            startAnimation();
          }
        });
        
        container.addEventListener('mousemove', (e) => {
          if (!isDown) return;
          e.preventDefault();
          
          const now = performance.now();
          const positionDelta = e.pageX - lastPosition;
          
          // Update target position with heavy friction feel (inverse for scroll)
          targetPosition = currentPosition - positionDelta * 1.3;
          
          // Check if we've moved enough to consider it dragging
          if (Math.abs(positionDelta) > dragThreshold) {
            isDragging = true;
          }
          
          lastPosition = e.pageX;
          lastTime = now;
        });
        
        // Touch events for mobile
        let touchStartX = 0;
        let touchStartTime = 0;
        let lastTouchX = 0;
        let lastTouchTime = 0;
        
        container.addEventListener('touchstart', (e) => {
          // Don't start drag if touching a link or button
          if (e.target.closest('a, button')) return;
          
          isDown = true;
          isDragging = false;
          updateMovingState(true);
          
          // Stop any ongoing animation
          if (animationFrameId) {
            cancelAnimationFrame(animationFrameId);
            animationFrameId = null;
          }
          
          touchStartX = e.touches[0].pageX;
          lastTouchX = touchStartX;
          touchStartTime = performance.now();
          lastTouchTime = touchStartTime;
          
          currentPosition = container.scrollLeft;
          targetPosition = currentPosition;
          velocity = 0;
          
          startAnimation();
        }, { passive: false });
        
        container.addEventListener('touchmove', (e) => {
          // Prevent the page from vertically scrolling while dragging horizontally
          e.preventDefault();
          if (!isDown) return;
          
          const touchX = e.touches[0].pageX;
          const now = performance.now();
          const positionDelta = touchX - lastTouchX;
          const timeDelta = Math.max(now - lastTouchTime, 1);
          
          // Update target position (inverse for scroll)
          targetPosition = currentPosition - positionDelta * 1.3;
          
          // Check if we've moved enough to consider it dragging
          if (Math.abs(touchX - touchStartX) > dragThreshold) {
            isDragging = true;
          }
          
          lastTouchX = touchX;
          lastTouchTime = now;
        }, { passive: false });
        
        container.addEventListener('touchend', (e) => {
          if (isDown) {
            isDown = false;
            
            // Calculate final velocity for momentum
            const now = performance.now();
            const timeDelta = Math.max(now - lastTouchTime, 1);
            const positionDelta = lastTouchX - touchStartX;
            
            // Convert touch movement to scroll velocity (inverse because scroll is opposite to touch)
            velocity = -(positionDelta / timeDelta) * 16.67 * MOMENTUM_MULTIPLIER;
            // Cap velocity to avoid excessive fling
            if (velocity > MAX_VELOCITY) velocity = MAX_VELOCITY;
            if (velocity < -MAX_VELOCITY) velocity = -MAX_VELOCITY;
            
            // Continue animation with momentum
            startAnimation();
          }
        }, { passive: false });
        
        // Sync scroll position on scroll events (for wheel scrolling)
        container.addEventListener('scroll', () => {
          if (!isDown && !animationFrameId) {
            currentPosition = container.scrollLeft;
            targetPosition = currentPosition;
            velocity = 0;
          }
          updateMovingState(true);
          if (scrollTimeoutId) {
            clearTimeout(scrollTimeoutId);
          }
          scrollTimeoutId = setTimeout(() => {
            if (!isDown && !animationFrameId) {
              updateMovingState(false);
            }
          }, 180);
        }, { passive: true });
      });
    })();
  </script>
  <script>
    // Page transition animation + navbar burger toggle
    (function() {
      const pageContent = document.getElementById('page-content');
      const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const currentPath = window.location.pathname.split('/').pop() || 'index.html';

      // Disable current page link in navbar
      document.querySelectorAll('nav a[href]').forEach(a => {
        const targetPath = a.getAttribute('href')?.split('/').pop();
        if (targetPath === currentPath) {
          a.classList.add('nav-link-disabled');
          a.setAttribute('aria-current', 'page');
        }
      });
      
      // Fade in on page load - but only if loading screen is not present
      function fadeIn() {
        const loadingScreen = document.getElementById('loading-screen');
        // Don't fade in if loading screen is still active
        if (loadingScreen && !loadingScreen.classList.contains('hidden')) {
          return;
        }
        // Ensure dark mode is applied before fade in
        const saved = localStorage.getItem('darkMode');
        if (saved === 'true') {
          document.body.classList.add('dark-mode');
        } else {
          document.body.classList.remove('dark-mode');
        }
        if (pageContent && !prefersReducedMotion) {
          requestAnimationFrame(() => {
            pageContent.classList.add('loaded');
          });
        } else if (pageContent) {
          pageContent.classList.add('loaded');
        }
      }
      
      // Fade out on navigation
      function handleNavigation(e) {
        const link = e.target.closest('a');
        if (!link) return;
        
        const href = link.getAttribute('href');
        if (!href) return;
        
        // Skip if it's an external link, mailto, tel, or anchor link
        if (href.startsWith('http') || href.startsWith('mailto:') || href.startsWith('tel:') || href.startsWith('#') || link.target === '_blank') {
          return;
        }
        
        // Skip if it's the same page
        const targetPath = href.split('/').pop();
        if (targetPath === currentPath) {
          return;
        }
        
        // Only handle .html files or relative paths (assumed to be HTML)
        if (!href.endsWith('.html') && !href.includes('.html') && (href.startsWith('/') || href.startsWith('http'))) {
          return;
        }
        
        e.preventDefault();
        
        // Check if dark mode is active and maintain it during transition
        const isDarkMode = document.body.classList.contains('dark-mode');
        if (isDarkMode) {
          document.documentElement.style.backgroundColor = '#1a1a1a';
          document.body.style.backgroundColor = '#1a1a1a';
        }
        
        if (pageContent && !prefersReducedMotion) {
          pageContent.style.opacity = '0';
          setTimeout(() => {
            window.location.href = href;
          }, 300);
        } else {
          window.location.href = href;
        }
      }
      
      // Add event listeners
      document.addEventListener('click', handleNavigation);
      
      // Fade in on load
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', fadeIn);
      } else {
        fadeIn();
      }
      
      // Also handle browser back/forward
      window.addEventListener('pageshow', (e) => {
        if (e.persisted) {
          fadeIn();
        }
      });

      // Burger toggle
      const nav = document.querySelector('nav.fixed-nav');
      const burgerBtn = document.getElementById('burger-btn');
      const burgerIcon = burgerBtn ? burgerBtn.querySelector('.material-symbols-outlined') : null;
      if (burgerBtn && nav && burgerIcon) {
        burgerBtn.addEventListener('click', () => {
          const isOpen = nav.classList.toggle('open');
          burgerBtn.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
          // Swap icon text for minimal animated cue
          burgerIcon.textContent = isOpen ? 'close' : 'menu';
          document.body.style.overflow = isOpen ? 'hidden' : '';
        });
        // Close on outside click (mobile)
        document.addEventListener('click', (e) => {
          if (!nav.classList.contains('open')) return;
          const within = e.target.closest('nav');
          if (!within) {
            nav.classList.remove('open');
            burgerBtn.setAttribute('aria-expanded', 'false');
            burgerIcon.textContent = 'menu';
            document.body.style.overflow = '';
          }
        });
      }
    })();
  </script>
  <script>
    // Dark mode functionality - must run immediately before page transitions
    (function() {
      const body = document.body;
      
      // Check for saved theme preference or default to light mode
      const getTheme = () => {
        const saved = localStorage.getItem('darkMode');
        return saved ? saved === 'true' : false;
      };
      
      // Update icon based on theme
      const updateIcon = (isDark) => {
        const moonIcon = document.getElementById('moon-icon');
        const sunIcon = document.getElementById('sun-icon');
        if (moonIcon && sunIcon) {
          if (isDark) {
            moonIcon.style.display = 'none';
            sunIcon.style.display = 'block';
          } else {
            moonIcon.style.display = 'block';
            sunIcon.style.display = 'none';
          }
        }
      };
      
      // Apply theme immediately (synchronously)
      const applyTheme = (isDark) => {
        if (isDark) {
          body.classList.add('dark-mode');
        } else {
          body.classList.remove('dark-mode');
        }
        localStorage.setItem('darkMode', isDark);
        updateIcon(isDark);
      };
      
      // Initialize theme IMMEDIATELY (before any animations)
      const isDark = getTheme();
      applyTheme(isDark);
      
      // Set up toggle button after DOM is ready
      const initToggle = () => {
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        if (darkModeToggle) {
          // Update icon on initial load
          updateIcon(isDark);
          
          darkModeToggle.addEventListener('click', () => {
            const isDark = body.classList.contains('dark-mode');
            applyTheme(!isDark);
          });
        }
      };
      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initToggle);
      } else {
        initToggle();
      }
    })();
  </script>
  </div>
</body>
</html>